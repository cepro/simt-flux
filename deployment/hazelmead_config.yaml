meters:
  acuvim2:
    "Mains incomer":
      id: 9fe7c7fa-f0f7-4998-b9bc-330adab2ec4c
      host: 192.168.8.110:502
      pollIntervalSecs: 2
      pt1: 400
      pt2: 400
      ct1: 1250
      ct2: 5
    "Tesla battery inverter":
      id: 8333c68b-d5e0-4caf-94f7-0e97c78b913a
      host: 192.168.8.111:502
      pollIntervalSecs: 2
      pt1: 400
      pt2: 400
      ct1: 1000
      ct2: 5
    "EV":
      id: 39666f1c-8165-478b-92be-b9941cf46d4d
      host: 192.168.8.113:502
      pollIntervalSecs: 2
      pt1: 400
      pt2: 400
      ct1: 400
      ct2: 5
    "Housing feeder 1":
      id: b4cf6c49-c577-48f0-8a49-9d3c5c3764c9
      host: 192.168.8.112:502
      pollIntervalSecs: 2
      pt1: 400
      pt2: 400
      ct1: 400
      ct2: 5
    "Housing feeder 2":
      id: f46075b4-3a8b-4a6a-a9ca-1022902b335b
      host: 192.168.8.114:502
      pollIntervalSecs: 2
      pt1: 400
      pt2: 400
      ct1: 400
      ct2: 5

bess:
  powerPack:
    host: 192.168.8.51:502
    id: 539cab31-6c7f-44ae-bd6a-744af19d8d0c
    pollIntervalSecs: 2
    nameplatePower: 565
    nameplateEnergy: 1609
    teslaOptions:
      inverterRampRateUp: 75
      inverterRampRateDown: 75
      alwaysActive: false

dataPlatforms:
  - # QA supabase
    uploadIntervalSecs: 60
    supabase:
      url: https://rkzgrxssutcwrauaazjz.supabase.co
      schema: flows
      anonKeyEnvVar: SUPABASE_ANON_KEY_QA
      userKeyEnvVar: SUPABASE_USER_KEY_QA
  - # Prod supabase
    uploadIntervalSecs: 60
    supabase:
      url: https://pqlwxerasppsyleweruk.supabase.co
      schema: flows
      anonKeyEnvVar: SUPABASE_ANON_KEY_PROD
      userKeyEnvVar: SUPABASE_USER_KEY_PROD

controller:
  siteMeter: 9fe7c7fa-f0f7-4998-b9bc-330adab2ec4c
  bessMeter: 8333c68b-d5e0-4caf-94f7-0e97c78b913a
  emulation:
    bessIsEmulated: false
    emulatedSiteMeter: null
  bessChargeEfficiency: 0.85
  bessSoeMin: 40
  bessSoeMax: 1280
  bessChargePowerLimit: 565
  bessDischargePowerLimit: 565
  siteImportPowerLimit: 220
  siteExportPowerLimit: 475
  controlComponents:
    importAvoidanceWhenShort:
      - shortPrediction:
          allowPrediction: true
          volumeCutoff: 0
          timeCutoffSecs: 1200  # 20mins
        period:
          days: all:Europe/London
          start: 00:00:00:Europe/London
          end: 23:59:59:Europe/London
    importAvoidance: []
    exportAvoidance:
      # Activate export avoidance at all times except weekday evening peaks
      - days: weekdays:Europe/London
        start: 00:00:00:Europe/London
        end: 17:00:00:Europe/London
      - days: weekdays:Europe/London
        start: 19:00:00:Europe/London
        end: 23:59:59:Europe/London
      - days: weekends:Europe/London
        start: 00:00:00:Europe/London
        end: 23:59:59:Europe/London
    chargeToSoe: []
    dischargeToSoe: []
    dynamicPeakDischarge:
      - 
        period:
          days: weekdays:Europe/London
          start: 17:00:00:Europe/London
          end: 19:00:00:Europe/London
        targetSoe: 30
        targetShortPeriods: true
        shortPrediction:
          allowPrediction: true
          volumeCutoff: 0
          timeCutoffSecs: 1200  # 20mins
        prioritiseResidualLoad: true
    nivChase:
      - period:
          days: weekdays:Europe/London
          start: 00:00:00:Europe/London
          end: 23:59:59:Europe/London
        niv:
          chargeCurve:
            points: [
              { "x": -99999, "y": 1280 },
              { "x": 4, "y": 1280 },
              { "x": 6, "y": 1000 },
              { "x": 12, "y": 0 }
            ]
          dischargeCurve:
            points: [
              { "x": 8, "y": 1280 },
              { "x": 18, "y": 1000 },
              { "x": 25, "y": 1000 },
              { "x": 35, "y": 0 },
              { "x": 99999, "y": 0 }
            ]
          curveShiftLong: 2
          curveShiftShort: 2
          defaultPricing: []
          pricePrediction:
            whenShort:
              allowPrediction: true
              volumeCutoff: 250000
              timeCutoffSecs: 900
            whenLong:
              allowPrediction: true
              volumeCutoff: 150000
              timeCutoffSecs: 900
      - period:
          days: weekends:Europe/London
          start: 00:00:00:Europe/London
          end: 23:59:59:Europe/London
        niv:
          chargeCurve:
            points: [
              { "x": -99999, "y": 1280 },
              { "x": -2, "y": 1280 },
              { "x": 6, "y": 400 },
              { "x": 12, "y": 0 }
              ]
          dischargeCurve:
            points: [
              { "x": 8, "y": 1280 },
              { "x": 14, "y": 400 },
              { "x": 35, "y": 100 },
              { "x": 99999, "y": 0 }
            ]
          curveShiftLong: 0
          curveShiftShort: 0
          defaultPricing: []
          pricePrediction:
            whenShort:
              allowPrediction: true
              volumeCutoff: 250000
              timeCutoffSecs: 900
            whenLong:
              allowPrediction: true
              volumeCutoff: 150000
              timeCutoffSecs: 900

  ratesImport:
    - # Unify supplier import
      rate: 1
      periods:
        - days: all:Europe/London
          start: 00:00:00:Europe/London
          end: 23:59:59:Europe/London
    - # Final consumption levies
      rate: 1.8  # This accounts for BSUoS at 1.29p/kWh and assumes a NCSP of 0.9 for the remaining fees for 0.5p/kWh
      periods:
        - days: all:Europe/London
          start: 00:00:00:Europe/London
          end: 23:59:59:Europe/London
    - # DUoS red import
      rate: 10.983
      periods:
        - days: weekdays:Europe/London
          start: 17:00:00:Europe/London
          end: 19:00:00:Europe/London
    - # DUoS amber import
      rate: 0.499
      periods:
        - days: weekdays:Europe/London
          start: 07:30:00:Europe/London
          end: 17:00:00:Europe/London
        - days: weekdays:Europe/London
          start: 19:00:00:Europe/London
          end: 21:30:00:Europe/London
        - days: weekends:Europe/London
          start: 16:30:00:Europe/London
          end: 19:30:00:Europe/London
    - # DUoS green import
      rate: 0.034
      periods:
        - days: weekdays:Europe/London
          start: 00:00:00:Europe/London
          end: 07:30:00:Europe/London
        - days: weekdays:Europe/London
          start: 21:30:00:Europe/London
          end: 23:59:59:Europe/London
        - days: weekends:Europe/London
          start: 00:00:00:Europe/London
          end: 16:30:00:Europe/London
        - days: weekends:Europe/London
          start: 19:30:00:Europe/London
          end: 23:59:59:Europe/London
  ratesExport:
    - # DUoS red export
      rate: -10.4
      periods:
        - days: weekdays:Europe/London
          start: 17:00:00:Europe/London
          end: 19:00:00:Europe/London
    - # DUoS amber export
      rate: -0.52
      periods:
        - days: weekdays:Europe/London
          start: 07:30:00:Europe/London
          end: 17:00:00:Europe/London
        - days: weekdays:Europe/London
          start: 19:00:00:Europe/London
          end: 21:30:00:Europe/London
        - days: weekends:Europe/London
          start: 16:30:00:Europe/London
          end: 19:30:00:Europe/London
    - # DUoS green export
      rate: -0.037
      periods:
        - days: weekdays:Europe/London
          start: 00:00:00:Europe/London
          end: 07:30:00:Europe/London
        - days: weekdays:Europe/London
          start: 21:30:00:Europe/London
          end: 23:59:59:Europe/London
        - days: weekends:Europe/London
          start: 00:00:00:Europe/London
          end: 16:30:00:Europe/London
        - days: weekends:Europe/London
          start: 19:30:00:Europe/London
          end: 23:59:59:Europe/London
